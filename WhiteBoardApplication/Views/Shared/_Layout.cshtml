<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>White Board Application</title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")

    @Scripts.Render("~/bundles/Generic")
    @Styles.Render("~/Content/literallycanvasCss")
    <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react-with-addons.js" type="text/javascript"></script>
    @Scripts.Render("~/bundles/LiterallycanvasJS")

    <script src="~/Scripts/app.js"></script>
</head>
<body>
   
  
    <div class="container body-content">
        @RenderBody()
        <hr />
        <footer>
            <p>&copy; @DateTime.Now.Year -White Board Application</p>
        </footer>
    </div>

    <!--Add script to update the page and send messages.-->
    <script type="text/javascript">

        $(document).ready(function () {
            // Declare a proxy to reference the hub.
            var chat = $.connection.chatHub;
            // Create a function that the hub can call to broadcast messages.

            chat.client.broadcastMessage = function (name, myscreenshot) {
                $("#spanName").show();
                $("#spanName").text('' + name + ' is typing...');
                lc.loadSnapshot(JSON.parse(myscreenshot));
                
            };
            // Get the user name and store it to prepend to messages.
            var UserName =prompt('Enter your name:', '');
           
            // Start the connection.
            if (UserName)
                $("#txtUserName").val(UserName)
            else
                $("#txtUserName").val("Anonymous")
         
            $('#displayname').text("Welcome " + $("#txtUserName").val());

            lc.on('drawEnd', function () {
                var myscreenshot = lc.getSnapshotJSON();
                chat.server.send($("#txtUserName").val(), myscreenshot);
            })

            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    var myscreenshot = lc.getSnapshotJSON();
                   // var objScreenshot = { msg: '', myscreenshot: myscreenshot, IsWritingCompleted: true }
                    chat.server.send($("#txtUserName").val(), myscreenshot);
                   
                });
            });
        });

    </script>
    @Scripts.Render("~/bundles/jquery")
    <!--Reference the SignalR library. -->
    <script src="/Scripts/jquery.signalR-2.2.2.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="/signalr/hubs"></script>
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
</body>
</html>
